CREATE TABLE STUDENTS
(
    STU_ID VARCHAR2(30) PRIMARY KEY,
    STU_FN VARCHAR2(30),
    STU_LN VARCHAR2(30)
);
INSERT ALL
INTO STUDENTS VALUES ('1','NAVEEN','R')
INTO STUDENTS VALUES ('2','ARUN','P')
INTO STUDENTS VALUES ('3','HARI','L')
INTO STUDENTS VALUES ('4','KUMAR','V')
INTO STUDENTS VALUES ('5','MANI','S')
SELECT * FROM DUAL;
SELECT * FROM STUDENTS;
DROP TABLE COURSES;
CREATE TABLE COURSES
(
    COU_ID VARCHAR2(30) PRIMARY KEY,
    COU_NAM VARCHAR2(30)
    
);
INSERT ALL
INTO COURSES VALUES ('101','CSE')
INTO COURSES VALUES ('102','EEE')
SELECT * FROM DUAL;
SELECT * FROM COURSES;
DROP TABLE GRADES;
CREATE TABLE GRADES
(
    GRADE VARCHAR2(30) PRIMARY KEY,
    GRADE_POINTS NUMBER(5,2)
    
);
INSERT ALL
INTO GRADES VALUES ('A+','9')
INTO GRADES VALUES ('O','10')
INTO GRADES VALUES ('A','8')
INTO GRADES VALUES ('U','0')
SELECT * FROM DUAL;
SELECT * FROM GRADES;
DROP TABLE STUDENT_COURSE;
CREATE TABLE STUDENT_COURSE
(
     STU_ID VARCHAR2(30) PRIMARY KEY,
     COU_ID VARCHAR2(30),
     GRADE VARCHAR2(30),
      FOREIGN KEY(STU_ID) REFERENCES STUDENTS(STU_ID),
      FOREIGN KEY(COU_ID) REFERENCES COURSES(COU_ID),
      FOREIGN KEY(GRADE) REFERENCES GRADES(GRADE)
    
);
INSERT ALL
INTO STUDENT_COURSE VALUES ('1','101','A')
INTO STUDENT_COURSE VALUES ('2','101','A')
INTO STUDENT_COURSE VALUES ('3','102','A+')
INTO STUDENT_COURSE VALUES ('4','102','O')
INTO STUDENT_COURSE VALUES ('5','102','A+')
SELECT * FROM DUAL;

//////////////////////////////////////////////////////////SUB QUERT AND CORRELATEDSUBQUERY/////////////////////

CREATE TABLE PRODUCT1
(
    PRODUCT_ID NUMBER,
    PRODUCT_NAME VARCHAR2(50),
    PRICE NUMBER
)
CREATE TABLE ITEM_LIST
(
    ITEM_ID NUMBER,
    NAME VARCHAR2(50),
    COST NUMBER
)
INSERT ALL
INTO PRODUCT1 VALUES(1,'A',1000)
INTO PRODUCT1 VALUES(2,'B',1500)
INTO PRODUCT1 VALUES(3,'C',1200)
INTO ITEM_LIST VALUES(4,'D',2000)
INTO ITEM_LIST VALUES(5,'E',2200)
SELECT * FROM DUAL;

SELECT * FROM ITEM_LIST;
SELECT * FROM HR.EPLOYEES WHERE DEPARTMENT_ID=
(SELECT DEPARTMENT_ID FROM HR.DEPARTMENTS WHERE DEPARTMENT_NAME='Finance')

SELECT * FROM HR.EPLOYEES WHERE DEPARTMENT_ID IN
(SELECT DEPARTMENT_ID FROM HR.DEPARTMENTS WHERE DEPARTMENT_NAME IN('Finance','Sales'))
SELECT * FROM PRODUCT1 WHERE (PRODUCT_ID,PRODUCT_NAME)=
(SELECT ITEM_ID,NAME FROM ITEM_LIST WHERE COST<2000)
SELECT * FROM PRODUCT1 WHERE (PRODUCT_ID,PRODUCT_NAME) IN
(SELECT ITEM_ID,NAME FROM ITEM_LIST WHERE COST<2500)


SELECT * FROM HR.DEPARTMENTS D WHERE 3<=
(SELECT COUNT(*) FROM HR.EMPLOYEES E WHERE E.DEPARTMENT_ID=D.DEPARTMENT_ID)

SELECT * FROM HR.DEPARTMENTS D WHERE 
EXISTS (SELECT E.EMPLOYEE_ID FROM HR.EMPLOYEES E WHERE E.DEPARTMENT_ID=D.DEPARTMENT_ID)

SELECT * FROM HR.DEPARTMENTS D WHERE 
NOT EXISTS (SELECT E.EMPLOYEE_ID FROM HR.EMPLOYEES E WHERE E.DEPARTMENT_ID=D.DEPARTMENT_ID)

SELECT * FROM HR.JOBS J WHERE 2<
(SELECT COUNT(*) FROM HR.EMPLOYEES E WHERE E.JOB_ID=J.JOB_ID)

SELECT * FROM HR.JOBS J WHERE 5=
(SELECT COUNT(*) FROM HR.EMPLOYEES E WHERE E.JOB_ID=J.JOB_ID)


SELECT T.DEPARTMENT_ID,T.EMP_COUNT,T.TOT_SALARY FROM
(SELECT E.DEPARTMENT_ID,COUNT(*) EMP_COUNT,SUM(SALARY) TOT_SALARY FROM HR.EMPLOYEES E
        GROUP BY E.DEPARTMENT_ID) T

WHERE T.EMP_COUNT>2 AND T.TOT_SALARY>10000

WITH T AS
(
    SELECT E.DEPARTMENT_ID,
    COUNT(*) EMP_COUNT,SUM(SALARY) TOL_SALARY
    FROM HR.EMPLOYEES E
    GROUP BY E.DEPARTMENT_ID
)
SELECT T.DEPARTMENT_ID,T.EMP_COUNT,T.TOL_SALARY FROM T
WHERE T.EMP_COUNT>2 AND T.TOL_SALARY>10000
SELECT * FROM  STUDENT_COURSE;
DROP TABLE STUDENT_COURSE;
